Acoustic and gravity waves are treated implicitly and advection is treated explicitly. The trapezoidal implicit treatment of fast waves and the Hodge operator suitable for non-orthogonal grids are described in appendix \ref{appx:SI}. To avoid time-splitting errors between the advection and the fast waves, the advection is time-stepped using a three-stage, second-order Runge-Kutta scheme. The advection terms of the momentum and $\theta$ equations, (\ref{eq:momentum}) and (\ref{eq:theta}), are discretised in flux form using the upwind-biased cubic scheme.

